(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b1f2785c"],{"0a69":function(e,t,a){"use strict";a("771d"),a("acdd")},"5c3a":function(e,t,a){"use strict";a("7579")},7579:function(e,t,a){},acdd:function(e,t,a){},d8ce:function(e,t,a){"use strict";a.r(t);a("5b81");var c=a("7a23"),l=(a("c4aa"),a("797a"),a("efc7"),a("cc66"),a("10c7"),a("751f"),a("858d"),a("4180"),a("0a35"),a("0a69"),a("2295")),r=a("c9a1"),o=a("3ef4"),i=a("db9d"),u=a("cf2e"),d=a("d8e8"),n=a("e0ad"),b=a("c349"),s=a("5c12"),v=a("91c0"),O=a("5502"),j=a("1dc4");const f={style:{"border-bottom":"#e0e0e0 1px solid",padding:"20px"}},p={class:"modal-title"},m={style:{"border-top":"#e0e0e0 1px solid",padding:"20px",display:"flex","justify-content":"space-between"}},x={style:{display:"flex"}},V={style:{flex:"1","margin-right":"5px"}},h={style:{"margin-top":"15px","font-weight":"bold","border-bottom":"silver 1px dotted","padding-bottom":"5px"}},g={style:{display:"flex","margin-top":"5px","align-content":"space-between","justify-content":"space-between","padding-top":"3px","padding-bottom":"3px","border-bottom":"1px dotted","border-color":"var(--el-color-info-light)"}},N={style:{flex:"1","margin-left":"5px","text-align":"center"}},y=["src"],w=Object(c["createElementVNode"])("br",null,null,-1),k=Object(c["createElementVNode"])("br",null,null,-1);var D={__name:"qr-device",setup(e,{expose:t}){const a=Object(O["b"])(),D=Object(c["ref"])(!1),C=Object(c["ref"])("first"),_=Object(c["ref"])(""),q=Object(c["ref"])(null),E=Object(c["ref"])(0),I=Object(c["ref"])(!1),T=Object(c["reactive"])({name:[{required:!0,message:Object(j["a"])("device.form.nameEmpty"),trigger:"blur"}],uniqueId:[{required:!0,message:Object(j["a"])("device.form.uniqueIdEmpty"),trigger:"blur"}]}),S=Object(c["ref"])(0),M=Object(c["ref"])(100),U=Object(c["ref"])(100),J=Object(c["ref"])(0),B=Object(c["ref"])(100),F=Object(c["ref"])(100),L=Object(c["ref"])(defaultDeviceData),R=()=>{const e=L.value.attributes["tarkan.color"],t=L.value.attributes["tarkan.color_extra"];if(e){const e=L.value.attributes["tarkan.color"].split("|");S.value=parseInt(e[0]?e[0]:0),M.value=parseInt(e[1]?100*e[1]:100),U.value=parseInt(e[2]?100*e[2]:100)}else S.value=0,M.value=0,U.value=180;if(t){const e=L.value.attributes["tarkan.color_extra"].split("|");J.value=parseInt(e[0]?e[0]:0),B.value=parseInt(e[1]?100*e[1]:100),F.value=parseInt(e[2]?100*e[2]:100)}else J.value=0,B.value=0,F.value=180},$=()=>{C.value="first",_.value=Object(j["a"])("device.add"),L.value=JSON.parse(JSON.stringify(defaultDeviceData)),D.value=!0,E.value=0},A=e=>{C.value="first",_.value=Object(j["a"])("device.manageQrCode"),L.value=JSON.parse(JSON.stringify(defaultDeviceData));const t=a.getters["devices/getDevice"](e);for(let a of Object.keys(defaultDeviceData))L.value[a]="attributes"===a?null===t[a]?{}:JSON.parse(JSON.stringify(t[a])):null===t[a]?"":t[a];R();const c=a.getters["devices/getPosition"](t.id);E.value=c?c.attributes["totalDistance"]:0;const l=document.location.protocol+"//"+document.location.host+"/qr-driver/scan/"+L.value.id;I.value="https://chart.googleapis.com/chart?cht=qr&chs=300x300&chl="+l+"&chld=H|1",D.value=!0},H=e=>fetch(e).then(e=>e.blob()).then(e=>URL.createObjectURL(e)),z=async()=>{const e=document.location.protocol+"//"+document.location.host+"/qr-driver/scan/"+L.value.id;var t=document.createElement("a");t.setAttribute("href",await H("https://chart.googleapis.com/chart?cht=qr&chs=300x300&chl="+e+"&chld=H|1")),t.setAttribute("download",L.value.id+"-"+L.value.name+".png"),document.body.appendChild(t),t.click(),t.remove()};t({newDevice:$,editDevice:A});const K=()=>{D.value=!1},P=()=>{q.value.validate(e=>{e?(L.value.attributes["tarkan.color"]=S.value+"|"+(M.value/100).toFixed(2)+"|"+(U.value/100).toFixed(2),L.value.attributes["tarkan.color_extra"]=J.value+"|"+(B.value/100).toFixed(2)+"|"+(F.value/100).toFixed(2),Object(l["a"])({title:Object(j["a"])("info"),message:Object(j["a"])("device.saving"),type:"info"}),L.value.uniqueId=L.value.uniqueId.trim(),a.dispatch("devices/save",L.value).then(e=>{a.dispatch("devices/accumulators",{deviceId:e.id,totalDistance:E.value}),Object(l["a"])({title:Object(j["a"])("success"),message:Object(j["a"])("device.saved"),type:"info"}),D.value=!1}).catch(e=>{const t=e.response.data.split("-")[0].trim().replaceAll(" ","_").toUpperCase();r["a"].alert(Object(j["a"])("device.error."+t),Object(j["a"])("device.saveError"),{confirmButtonText:"OK"})})):o["a"].error(Object(j["a"])("device.error.checkForm"))})};return(e,t)=>(Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["unref"])(i["a"]),{"lock-scroll":!0,modelValue:D.value,"onUpdate:modelValue":t[8]||(t[8]=e=>D.value=e)},{title:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("div",f,[Object(c["createElementVNode"])("div",p,Object(c["toDisplayString"])(_.value),1)])]),footer:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("div",m,[Object(c["createVNode"])(Object(c["unref"])(u["a"]),{type:"danger",plain:"",onClick:t[0]||(t[0]=e=>K())},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(Object(c["unref"])(j["a"])("cancel")),1)]),_:1}),Object(c["createVNode"])(Object(c["unref"])(u["a"]),{type:"primary",onClick:t[1]||(t[1]=e=>P())},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(Object(c["unref"])(j["a"])("save")),1)]),_:1})])]),default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(d["a"]),{ref_key:"formRef",ref:q,model:L.value,rules:T,"label-width":"120px","label-position":"top"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(n["b"]),{modelValue:C.value,"onUpdate:modelValue":t[7]||(t[7]=e=>C.value=e)},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(n["a"]),{label:Object(c["unref"])(j["a"])("device.device"),name:"first"},{default:Object(c["withCtx"])(()=>[Object(c["createElementVNode"])("div",x,[Object(c["createElementVNode"])("div",V,[Object(c["createVNode"])(Object(c["unref"])(d["b"]),{label:Object(c["unref"])(j["a"])("device.imei"),prop:"uniqueId"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(b["a"]),{disabled:"",modelValue:L.value.uniqueId,"onUpdate:modelValue":t[2]||(t[2]=e=>L.value.uniqueId=e)},null,8,["modelValue"])]),_:1},8,["label"]),Object(c["createVNode"])(Object(c["unref"])(d["b"]),{label:Object(c["unref"])(j["a"])("device.name"),prop:"name"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(b["a"]),{disabled:"",modelValue:L.value.name,"onUpdate:modelValue":t[3]||(t[3]=e=>L.value.name=e)},null,8,["modelValue"])]),_:1},8,["label"]),Object(c["createElementVNode"])("div",h,Object(c["toDisplayString"])(e.$t("driver.qrDriver.behaviorRules")),1),Object(c["createElementVNode"])("div",g,[Object(c["createElementVNode"])("div",null,Object(c["toDisplayString"])(e.$t("driver.qrDriver.lockDevice")),1),Object(c["createVNode"])(Object(c["unref"])(s["a"]),{modelValue:L.value["attributes"]["tarkan.driverLockDevice"],"onUpdate:modelValue":t[4]||(t[4]=e=>L.value["attributes"]["tarkan.driverLockDevice"]=e),"inactive-text":e.$t("no"),"active-text":e.$t("yes"),"active-value":1,"inactive-value":0},null,8,["modelValue","inactive-text","active-text"])]),Object(c["createVNode"])(Object(c["unref"])(d["b"]),{label:Object(c["unref"])(j["a"])("driver.qrDriver.lockDeviceTimeout"),prop:"name"},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(v["c"]),{size:"large",modelValue:L.value["attributes"]["tarkan.lockDeviceTimeout"],"onUpdate:modelValue":t[5]||(t[5]=e=>L.value["attributes"]["tarkan.lockDeviceTimeout"]=e)},{default:Object(c["withCtx"])(()=>[Object(c["createVNode"])(Object(c["unref"])(v["a"]),{value:1,label:"1 Minuto"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("1 Minuto")]),_:1}),Object(c["createVNode"])(Object(c["unref"])(v["a"]),{value:2,label:"2 Minutos"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("2 Minutos")]),_:1}),Object(c["createVNode"])(Object(c["unref"])(v["a"]),{value:3,label:"3 Minutos"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("3 Minutos")]),_:1}),Object(c["createVNode"])(Object(c["unref"])(v["a"]),{value:4,label:"4 Minutos"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("4 Minutos")]),_:1}),Object(c["createVNode"])(Object(c["unref"])(v["a"]),{value:5,label:"5 Minutos"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("5 Minutos")]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),Object(c["createElementVNode"])("div",N,[I.value?(Object(c["openBlock"])(),Object(c["createElementBlock"])("img",{key:0,src:I.value},null,8,y)):Object(c["createCommentVNode"])("",!0),w,Object(c["createVNode"])(Object(c["unref"])(u["a"]),{onClick:t[6]||(t[6]=e=>z()),type:"primary"},{default:Object(c["withCtx"])(()=>[Object(c["createTextVNode"])("Download")]),_:1}),k])])]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue"]))}};a("5c3a");const C=D;t["default"]=C}}]);