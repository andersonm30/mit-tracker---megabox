{"version":3,"sources":["webpack:///./src/templates/history.vue?f42e","webpack:///./src/templates/history.vue","webpack:///./src/templates/history.vue?dfa9"],"names":["loading","date1","Date","date2","setHours","setMinutes","formData","deviceId","date","store","route","query","value","parseInt","loadRoute","updateRoute","shortcuts","text","end","start","setSeconds","setDate","getDate","setTime","getTime","routePoints","$traccar","window","then","data","tmp","forEach","p","push","latitude","longitude","id","course","__exports__"],"mappings":"gHAAA,W,k4HC+GA,IAAMA,EAAU,kBAAI,GAEdC,EAAQ,IAAIC,KACZC,EAAQ,IAAID,KAElBD,EAAMG,SAAS,GACfH,EAAMI,WAAW,GAGjB,IAAMC,EAAW,iBAAI,CAACC,SAAU,GAAGC,KAAM,CAACP,EAAME,KAC1CM,EAAQ,iBACRC,EAAQ,iBAEd,wBAAU,WACLA,EAAMC,MAAMJ,WACbD,EAASM,MAAML,SAAWM,SAASH,EAAMC,MAAMJ,UAE/CO,QAIJ,8BAAgB,WACdC,EAAY,OAGd,oBAAM,kBAAKL,EAAMC,MAAMJ,YAAS,WAC3BG,EAAMC,MAAMJ,WACbD,EAASM,MAAML,SAAWM,SAASH,EAAMC,MAAMJ,UAE/CO,QAIJ,IAAMC,EAAc,oBAAO,eAErBC,EAAY,iBAAI,CACpB,CACEC,KAAM,OACNL,MAAO,WACL,IAAMM,EAAM,IAAIhB,KACViB,EAAQ,IAAIjB,KAKlB,OAJAiB,EAAMf,SAAS,GACfe,EAAMd,WAAW,GACjBc,EAAMC,WAAW,GAEV,CAACD,EAAOD,KAGnB,CACED,KAAM,QACNL,MAAO,WACL,IAAMM,EAAM,IAAIhB,KACViB,EAAQ,IAAIjB,KAYlB,OAXAiB,EAAMf,SAAS,GACfe,EAAMd,WAAW,GACjBc,EAAMC,WAAW,GACjBD,EAAME,QAAQF,EAAMG,UAAU,GAE9BJ,EAAId,SAAS,GACbc,EAAIb,WAAW,GACfa,EAAIE,WAAW,GAIR,CAACD,EAAOD,KAGnB,CACED,KAAM,cACNL,MAAO,WACL,IAAMM,EAAM,IAAIhB,KACViB,EAAQ,IAAIjB,KAElB,OADAiB,EAAMI,QAAQJ,EAAMK,UAAY,QACzB,CAACL,EAAOD,KAGnB,CACED,KAAM,WACNL,MAAO,WACL,IAAMM,EAAM,IAAIhB,KACViB,EAAQ,IAAIjB,KAElB,OADAiB,EAAMI,QAAQJ,EAAMK,UAAY,QACzB,CAACL,EAAOD,KAGnB,CACED,KAAM,UACNL,MAAO,WACL,IAAMM,EAAM,IAAIhB,KACViB,EAAQ,IAAIjB,KAElB,OADAiB,EAAMI,QAAQJ,EAAMK,UAAY,QACzB,CAACL,EAAOD,OAKfO,EAAc,iBAAI,IAElBX,EAAY,WAChB,IAAMY,EAAWC,OAAOD,SAExB1B,EAAQY,OAAQ,EAEhBc,EAASZ,UAAUR,EAASM,MAAML,SAASD,EAASM,MAAMJ,KAAK,GAAGF,EAASM,MAAMJ,KAAK,IAAIoB,MAAK,YAAU,IAARC,EAAQ,EAARA,KAE7FJ,EAAYb,MAAQiB,EAEpB,IAAIC,EAAM,GACVD,EAAKE,SAAQ,SAACC,GACZF,EAAIG,KAAK,CAACD,EAAEE,SAASF,EAAEG,UAAUH,EAAEI,GAAGJ,EAAEK,YAG1CtB,EAAYe,GACZ9B,EAAQY,OAAQ,M,6qJC1NtB,MAAM0B,EAA2B,IAAgB,EAAQ,CAAC,CAAC,YAAY,qBAExD","file":"js/chunk-07c6c7fd.417eb4bf.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./history.vue?vue&type=style&index=0&id=fc79800a&scoped=true&lang=css\"","<template>\r\n  <el-form>\r\n  <el-form-item >\r\n    <el-select v-model=\"formData.deviceId\" :value-key=\"'id'\" filterable placeholder=\"Veiculo\" :size=\"'large'\" :no-data-text=\"'Nenhum dispositivo encontrado'\">\r\n      <el-option\r\n          v-for=\"item in store.state.devices.deviceList\"\r\n          :key=\"item.id\"\r\n          :label=\"item.name\"\r\n          :value=\"item.id\"\r\n      >\r\n      </el-option>\r\n    </el-select>\r\n  </el-form-item>\r\n   <div style=\"display: flex;\">\r\n     <div style=\"width: 100px\"></div>\r\n      <el-date-picker\r\n          v-model=\"formData.date\"\r\n          type=\"datetimerange\"\r\n          :shortcuts=\"shortcuts\"\r\n          range-separator=\"Até\"\r\n          format=\"DD/MM/YYYY HH:mm\"\r\n          start-placeholder=\"Data Inicial\"\r\n          end-placeholder=\"Data Final\"\r\n\r\n      >\r\n      </el-date-picker>\r\n     <div style=\"width: 5px\"></div>\r\n     <el-tooltip\r\n         effect=\"dark\"\r\n         content=\"Carregar Rotas\"\r\n         placement=\"bottom\"\r\n     >\r\n       <el-button type=\"primary\" @click=\"loadRoute()\"><i class=\"fas fa-route\"></i></el-button>\r\n     </el-tooltip>\r\n   </div>\r\n  </el-form>\r\n\r\n\r\n  <div class=\"device\" style=\"display: flex;flex-direction: column;\">\r\n    <template v-if=\"loading\">\r\n\r\n      <div style=\"text-align: center;padding: 40px;\">Carregando rota...</div>\r\n    </template>\r\n    <template v-else-if=\"routePoints.length===0\">\r\n      <div style=\"text-align: center;padding: 40px;\">Não há posicionamento para o periôdo selecionado.</div>\r\n    </template>\r\n    <template v-else>\r\n      <div v-if=\"routePoints.length>0\" style=\"border-bottom: silver 1px dotted;display: flex;\">\r\n        <div style=\"text-align: right;padding: 10px;font-size: 11px; color: #5b5b5b;position: relative;width: 70px;\">\r\n          <div style=\"position: absolute;border-right: #cbcbcb 1px dashed;width: 1px;height: 55%;right: 3px;bottom: 0%;transform: translate(-55%,0)\"></div>\r\n          <div style=\"position: absolute;background: #05a7e3;width: 10px;height: 10px;right: 0px;top: 50%;border-radius: 50%;transform: translateY(-50%)\"></div>\r\n          <div style=\"position: absolute;right: 15px;top: 50%;border-radius: 50%;transform: translateY(-50%)\">\r\n            {{new Date(routePoints[0].serverTime).toLocaleDateString()}}<br>\r\n            {{new Date(routePoints[0].serverTime).toLocaleTimeString()}}\r\n          </div>\r\n        </div>\r\n        <div style=\"padding: 10px;font-size: 14px;flex: 1;\">{{routePoints[0].address}}</div>\r\n\r\n        <div style=\"padding: 10px;width: 70px;text-align: right;font-size: 12px;margin-right: 1px;\">\r\n          <i class=\"fas fa-tachometer-alt\"></i>\r\n          {{Math.round(routePoints[0].speed)}} km/h\r\n        </div>\r\n      </div>\r\n      <div v-if=\"routePoints.length>2\" style=\"flex: 1;overflow: auto;\">\r\n        <template v-for=\"(p,k) in routePoints\" :key=\"p.id\">\r\n            <div v-if=\"k>0 && k<routePoints.length-1\" style=\"display: flex;border-bottom: silver 1px dotted;\">\r\n\r\n              <div style=\"text-align: right;padding: 10px;font-size: 11px; color: #5b5b5b;position: relative;width: 70px;\">\r\n                <div style=\"position: absolute;border-right: #cbcbcb 1px dashed;width: 1px;height: 100%;right: 3px;bottom: 0%;transform: translate(-55%,0)\"></div>\r\n                <div style=\"position: absolute;background: #05a7e3;width: 10px;height: 10px;right: 0px;top: 50%;border-radius: 50%;transform: translateY(-50%)\"></div>\r\n                <div style=\"position: absolute;right: 15px;top: 50%;border-radius: 50%;transform: translateY(-50%)\">\r\n                  {{new Date(p.serverTime).toLocaleDateString()}}<br>\r\n                  {{new Date(p.serverTime).toLocaleTimeString()}}\r\n                </div>\r\n              </div>\r\n              <div style=\"padding: 10px;font-size: 12px;flex: 1;\">{{p.address || 'Endereço não encontrado' }}</div>\r\n              <div style=\"padding: 10px;font-size: 12px;width: 70px;text-align: right\">\r\n                <i class=\"fas fa-tachometer-alt\"></i>\r\n                {{Math.round(p.speed)}} km/h\r\n              </div>\r\n\r\n            </div>\r\n        </template>\r\n      </div>\r\n    <div v-if=\"routePoints.length>0\" style=\"border-top: silver 1px dotted;display: flex;\">\r\n      <div style=\"text-align: right;padding: 10px;font-size: 11px; color: #5b5b5b;position: relative;width: 70px;\">\r\n        <div style=\"position: absolute;border-right: #cbcbcb 1px dashed;width: 1px;height: 55%;right: 3px;top: 0%;transform: translate(-55%,0)\"></div>\r\n        <div style=\"position: absolute;background: #05a7e3;width: 10px;height: 10px;right: 0px;top: 50%;border-radius: 50%;transform: translateY(-50%)\"></div>\r\n        <div style=\"position: absolute;right: 15px;top: 50%;border-radius: 50%;transform: translateY(-50%)\">\r\n          {{new Date(routePoints[routePoints.length-1].serverTime).toLocaleDateString()}}<br>\r\n          {{new Date(routePoints[routePoints.length-1].serverTime).toLocaleTimeString()}}\r\n        </div>\r\n      </div>\r\n      <div style=\"padding: 10px;font-size: 14px;flex: 1;\">{{routePoints[routePoints.length-1].address}}</div>\r\n      <div style=\"padding: 10px;font-size: 12px;width: 70px;text-align: right;margin-right: 1px;\">\r\n        <i class=\"fas fa-tachometer-alt\"></i>\r\n        {{Math.round(routePoints[routePoints.length-1].speed)}} km/h\r\n      </div>\r\n    </div>\r\n    </template>\r\n  </div>\r\n\r\n</template>\r\n\r\n<script setup>\r\n\r\nimport {ref,inject,onMounted,watch,onBeforeUnmount} from 'vue';\r\nimport {useStore} from 'vuex';\r\nimport {useRoute} from 'vue-router'\r\n\r\n\r\nconst loading = ref(false);\r\n\r\nconst date1 = new Date();\r\nconst date2 = new Date();\r\n\r\ndate1.setHours(0);\r\ndate1.setMinutes(0);\r\n\r\n\r\nconst formData = ref({deviceId: '',date: [date1,date2]})\r\nconst store = useStore();\r\nconst route = useRoute();\r\n\r\nonMounted(()=>{\r\n  if(route.query.deviceId){\r\n    formData.value.deviceId = parseInt(route.query.deviceId);\r\n\r\n    loadRoute();\r\n  }\r\n})\r\n\r\nonBeforeUnmount(()=>{\r\n  updateRoute([]);\r\n})\r\n\r\nwatch(()=> route.query.deviceId,()=>{\r\n  if(route.query.deviceId){\r\n    formData.value.deviceId = parseInt(route.query.deviceId);\r\n\r\n    loadRoute();\r\n  }\r\n})\r\n\r\nconst updateRoute = inject('updateRoute');\r\n\r\nconst shortcuts = ref([\r\n  {\r\n    text: 'Hoje',\r\n    value: () => {\r\n      const end = new Date()\r\n      const start = new Date()\r\n      start.setHours(0);\r\n      start.setMinutes(0);\r\n      start.setSeconds(0);\r\n\r\n      return [start, end]\r\n    },\r\n  },\r\n  {\r\n    text: 'Ontem',\r\n    value: () => {\r\n      const end = new Date()\r\n      const start = new Date()\r\n      start.setHours(0);\r\n      start.setMinutes(0);\r\n      start.setSeconds(0);\r\n      start.setDate(start.getDate()-1);\r\n\r\n      end.setHours(0);\r\n      end.setMinutes(0);\r\n      end.setSeconds(0);\r\n\r\n\r\n\r\n      return [start, end]\r\n    },\r\n  },\r\n  {\r\n    text: 'Esta semana',\r\n    value: () => {\r\n      const end = new Date()\r\n      const start = new Date()\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 7)\r\n      return [start, end]\r\n    },\r\n  },\r\n  {\r\n    text: 'Este mês',\r\n    value: () => {\r\n      const end = new Date()\r\n      const start = new Date()\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 30)\r\n      return [start, end]\r\n    },\r\n  },\r\n  {\r\n    text: '3 meses',\r\n    value: () => {\r\n      const end = new Date()\r\n      const start = new Date()\r\n      start.setTime(start.getTime() - 3600 * 1000 * 24 * 90)\r\n      return [start, end]\r\n    },\r\n  },\r\n]);\r\n\r\nconst routePoints = ref([]);\r\n\r\nconst loadRoute = ()=>{\r\n  const $traccar = window.$traccar;\r\n\r\n  loading.value = true;\r\n\r\n  $traccar.loadRoute(formData.value.deviceId,formData.value.date[0],formData.value.date[1]).then(({data})=>{\r\n\r\n      routePoints.value = data;\r\n\r\n      let tmp = [];\r\n      data.forEach((p)=>{\r\n        tmp.push([p.latitude,p.longitude,p.id,p.course]);\r\n      });\r\n\r\n      updateRoute(tmp);\r\n      loading.value = false;\r\n  })\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.el-select.el-select--large{\r\n  width: 100%;\r\n}\r\n\r\n.device{\r\n  border: silver 1px solid;\r\n  height: calc(100vh - 260px);\r\n  border-radius: 5px;\r\n  margin-top: 20px;\r\n}\r\n</style>","import script from \"./history.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./history.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./history.vue?vue&type=style&index=0&id=fc79800a&scoped=true&lang=css\"\n\nimport exportComponent from \"E:\\\\Vue3\\\\tarkan-basic\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-fc79800a\"]])\n\nexport default __exports__"],"sourceRoot":""}